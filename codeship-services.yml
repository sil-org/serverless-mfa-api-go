test:
  build:
    dockerfile_path: Dockerfile
  cached: true
  encrypted_env_file: aws.env.encrypted
  environment:
    AWS_ENDPOINT: dynamo:8000
    AWS_DEFAULT_REGION: us-east-1
    AWS_DISABLE_SSL: "true"
    API_KEY_TABLE: ApiKey
    WEBAUTHN_TABLE: WebAuthn
    LAMBDA_ROLE: placeholder
  depends_on:
    - dynamo

app:
  build:
    dockerfile_path: Dockerfile
  cached: true
  encrypted_env_file: aws.env.encrypted
  working_dir: /src

dynamo:
  image: amazon/dynamodb-local
  environment:
    AWS_ACCESS_KEY_ID: abc123
    AWS_SECRET_ACCESS_KEY: abc123
    AWS_DEFAULT_REGION: us-east-1
  command: "-jar DynamoDBLocal.jar -sharedDb"

ga4tracker:
  image: silintl/ga-event-tracker:1.0.1
  encrypted_env_file: aws.env.encrypted
  environment:
    GA_MEASUREMENT_ID: G-NY4R8HM3Y3
    GA_CLIENT_ID: serverless_mfa_api_go
    # GA_EVENT_NAME is set by the codeship-steps command
    # Add to the aws.env.encrypted file ... GA_API_SECRET
